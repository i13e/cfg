#!/bin/sh
# media-control is a script that wraps around playerctl and controls
# active terminal music players directly instead of through MPRIS.
# dependencies: mpc, cmus, playerctl

#active=$(mpc current | wc -l)
active=$(cmus-remote -C status | wc -l)

# If output is only one line, likely that mpd is actively playing
if [ "$active" -gt 1 ]; then
	# translate playerctl commands to mpc commands
	case "$1" in
	play-pause)
		#mpc toggle
		cmus-remote -u
		;;
	previous)
		#mpc prev
		cmus-remote -r
		;;
	next)
		#mpc "$@"
		cmus-remote -n
		;;
	stop)
		cmus-remote -s
		;;
	# for lockscreen
	status)
		cmus-remote -C status | grep status | sed 's@status\ p@\P@g'
		;;
	pause)
		cmus-remote -U
		;;
	play)
		cmus-remote -p
		;;
	*)
		# mpc "$@"
		cmus-remote "$@"
		;;
	esac
elif command -v playerctl >/dev/null; then
	playerctl "$@"
else
	# echo "mpd is not running, and playerctl is not in your \$PATH"
	echo "cmus is not running, and playerctl is not in your \$PATH"
fi
